{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    Information about your partner
{% endblock %}

{% block content %}
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
        .red {
            color: red;
            font-weight: bold;
        }

        .green {
            color: green;
            font-weight: bold;
        }
    </style>


    {% if group.agreement %}
        <div class="alert alert-success text-center lead">
            <div class="text-h1 display-1">ðŸ˜Š</div>
            Your matched partner <b class="green">AGREES</b> with you on all of the following statements:
        </div>
    {% else %}
        <div class="alert alert-danger text-center lead">
            <div class="text-h1 display-1">ðŸ˜ž</div>
            Your matched partner <b class="red">DISAGREES</b> with you on at least one of the following statements:
        </div>
    {% endif %}


    <ul class="list-group my-3 list-group-flush" id="statementList">
        {% for i in statements %}
            <li class="list-group-item animate__animated  animate__zoomIn" style="display:none;">
                <!-- Initially hide the items -->
                {{ i.text }}
            </li>
        {% endfor %}
    </ul>
    <div id="instructions" class="my-3">
        Click 'Next' to see statements you {{ agreement_status }} with your partner.
    </div>
    <button id="revealButton" class="btn btn-primary" type="button">Next</button>

    <div id="clock" class="alert alert-info d-none">You can proceed in <span id="time">30</span> seconds</div>

    <div class="d-none animate__animated animate__zoomIn animate__slower" id="next-button">
        {% next_button %}
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.countdown/2.2.0/jquery.countdown.min.js"></script>

    <script>
        $(document).ready(function () {
            console.debug('Document ready')
            var finalDate = new Date().getTime() + js_vars.seconds_on_page*1000; // Current time + 30 sec

            $('#clock').countdown(finalDate)
                .on('update.countdown', function (event) {

                    const ending = event.strftime('%S') === '01' ? 'second' : 'seconds';
                    $('#clock').text(`You can proceed in ${event.strftime('%S')} ${ending}`);
                })
                .on('finish.countdown', function (event) {
                    $('#next-button').removeClass('d-none'); // Show the next button
                    $('#clock').hide(); // Optionally hide the countdown message
                });
        });
    </script>
    <script>
        // JavaScript to handle revealing list items one by one
        var listItems = document.querySelectorAll('#statementList .list-group-item');
        var currentItem = 0; // track the current item index

        document.getElementById('revealButton').addEventListener('click', function () {
            if (currentItem < listItems.length) {
                listItems[currentItem].style.display = 'block'; // show the current item
                currentItem++; // increment the index to point to the next item
            }
            if (currentItem === listItems.length) {
                document.getElementById('instructions').style.display = 'none'; // hide the instruction div
                document.getElementById('revealButton').style.display = 'none'; // hide the button
                $('#clock').removeClass('d-none'); // Show the countdown
                // let's show next block in timeout of 2 seconds


            }
        });
    </script>




{% endblock %}


