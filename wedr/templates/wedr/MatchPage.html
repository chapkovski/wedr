{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    {% if  group.show_disagreement %}  Information about your partner
    {% else %}
        Summary of your answers
    {% endif %}
{% endblock %}

{% block content %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.countdown/2.2.0/jquery.countdown.min.js"></script>
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
        .red {
            color: red;
            font-weight: bold;
        }

        .green {
            color: green;
            font-weight: bold;
        }

        .lightgreen {
            background: rgba(144, 238, 144, 0.5); /* lightgreen with 50% opacity */
        }

        .lightred {
            background: rgba(240, 128, 128, 0.5); /* lightcoral with 50% opacity */
        }
    </style>

    {% if  group.show_disagreement %}
        {% if group.agreement %}
            <div class="alert alert-success text-center lead">
                <div class="text-h1 display-1">ðŸ˜Š</div>
                Your partner <b class="green">AGREES</b> with you on on at least one of the following statements:
            </div>
        {% else %}
            <div class="alert alert-danger text-center lead">
                <div class="text-h1 display-1">ðŸ˜ž</div>
                Your partner <b class="red">DISAGREES</b> with you on at least one of the following statements:
            </div>
        {% endif %}
    {% endif %}
    <table class="table table-stripped table-hover" id="statementList">
        <thead>
        <tr>
            <th>Statement</th>

            {% if not group.show_disagreement %}
                <th>Your response</th>

            {% endif %}
            {% if group.show_details %}
                <th>Your response</th>
                <th>Partner's response</th>
            {% endif %}
        </tr>
        </thead>
        {% for i in statements %}
            <tr class=" myrow animate__animated  animate__zoomIn">
                <td> {{ i.0.text }}</td>
                {% if not group.show_disagreement %}
                    <td class="{{ i.0.color }}">
                        {{ i.0.response_text }}
                    </td>

                {% endif %}
                {% if group.show_details %}
                    <td class="{{ i.0.color }}">
                        {{ i.0.response_text }}
                    </td>
                    <td class="{{ i.1.color }}">
                        {{ i.1.response_text }}
                    </td>
                {% endif %}
                <!-- Initially hide the items -->

            </tr>
        {% endfor %}
    </table>
    {% if  group.show_disagreement %}
        <div class="text-secondary font-italic">
            Here, 'agree' means that you and your partner share similar views on certain statements. 'Disagree'
            indicates
            that your partner holds an opposite opinion from yours on the specified topics.
        </div>
    {% endif %}
    <div id="clock" class="alert alert-info d-none">You can proceed in <span id="time">30</span> seconds</div>

    <div class="d-none animate__animated animate__zoomIn animate__slower" id="next-button">
        {% next_button %}
    </div>

    <script>
        $(document).ready(function () {
            console.debug('Document ready');
        });

        // JavaScript to handle revealing list items one by one
        var listItems = document.querySelectorAll('#statementList .myrow');
        var currentItem = 0; // track the current item index

        startCountdown(); // Start the countdown

        function startCountdown() {
            var finalDate = new Date().getTime() + js_vars.seconds_on_page * 1000; // Current time + seconds defined in js_vars
            $('#clock').countdown(finalDate)
                .on('update.countdown', function (event) {
                    const ending = event.strftime('%S') === '01' ? 'second' : 'seconds';
                    if (event.elapsed) {
                        $('#clock').hide(); // Hide if elapsed
                        $('#next-button').removeClass('d-none'); // Show the next button
                    } else {
                        $('#clock').text(`You can proceed in ${event.strftime('%S')} ${ending}`);
                    }
                })
                .on('finish.countdown', function (event) {
                    $('#clock').hide(); // Optionally hide the countdown message
                    $('#next-button').removeClass('d-none'); // Show the next button
                })
                .removeClass('d-none'); // Ensure the countdown is visible if it was previously hidden
        }
    </script>


{% endblock %}


